<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project name="AdapterDocRetrieve" resourceRoot="" soapui-version="4.0.0" abortOnError="false" runType="SEQUENTIAL" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:WsdlInterface" wsaVersion="NONE" name="AdapterDocRetrieveBindingSoap11" type="wsdl" bindingName="{urn:gov:hhs:fha:nhinc:adapterdocretrieve}AdapterDocRetrieveBindingSoap11" soapVersion="1_1" anonymous="optional" definition="http://192.168.25.157:9080/NhinConnect/AdapterDocRetrieve?wsdl" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:endpoints><con:endpoint>http://localhost:${HttpDefaultPort}/NhinConnect/AdapterDocRetrieve</con:endpoint><con:endpoint>http://ATHC-GFAS:9080/NhinConnect/AdapterDocRetrieve</con:endpoint><con:endpoint>http://mhsnhie3.fedsconnect.org:9080/NhinConnect/AdapterDocRetrieve</con:endpoint><con:endpoint>http://dvanhie3.fedsconnect.org:9080/NhinConnect/AdapterDocRetrieve</con:endpoint></con:endpoints><con:operation isOneWay="false" action="urn:RespondingGateway_CrossGatewayRetrieve" name="RespondingGateway_CrossGatewayRetrieve" bindingOperationName="RespondingGateway_CrossGatewayRetrieve" type="Request-Response" outputName="RespondingGateway_CrossGatewayRetrieveResponse" inputName="RespondingGateway_CrossGatewayRetrieveRequest" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/></con:operation></con:interface><con:testSuite name="AdapterDocRetrieve TestSuite"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Doc Not Found" searchProperties="true" id="0d3aee83-4cb6-4c80-8aeb-f148cf809de8"><con:settings/><con:testStep type="properties" name="Test Case Properties"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:source>C:/projects/nhinc/Current/Product/IntegrationTest/default.properties</con:source><con:properties><con:property><con:name>SUT.PatientCorrelationFacade</con:name><con:value>http://172.16.50.82:9080/PatientCorrelationFacadeService</con:value></con:property><con:property><con:name>SUT.PatientCorrelationHost</con:name><con:value>192.168.25.157</con:value></con:property><con:property><con:name>SUT.PatientCorrelationPort</con:name><con:value>3306</con:value></con:property><con:property><con:name>SUT.PatientCorrelationDB</con:name><con:value>patientcorrelationdb</con:value></con:property><con:property><con:name>SUT.PatientCorrelationUser</con:name><con:value>epcuser</con:value></con:property><con:property><con:name>SUT.PatientCorrelationPass</con:name><con:value>epcpass</con:value></con:property><con:property><con:name>SUT.PatientCorrelationTable</con:name><con:value>correlatedidentifiers</con:value></con:property><con:property><con:name>SUT.PatientCorrelation</con:name><con:value>http://172.16.50.82:9080/PatientCorrelationService</con:value></con:property><con:property><con:name>SUT.EntityEndpoint</con:name><con:value>http://mhsnhie2.fedsconnect.org:18181/EntityServiceService/EntityServicePort</con:value></con:property><con:property><con:name>SUT.RemoteMPI</con:name><con:value>//192.168.25.157/glassfish/domains/domain1/config/mpi.xml</con:value></con:property><con:property><con:name>SUT.LocalMPI</con:name><con:value>//192.168.25.157/glassfish/domains/domain1/config/mpi.xml</con:value></con:property><con:property><con:name>SUT.EntityDocQueryEndpoint</con:name><con:value>http://192.168.25.157:10080/NhinConnect/EntityDocQuery</con:value></con:property><con:property><con:name>SUT.EntityDocRetrieveEndpoint</con:name><con:value>http://192.168.25.157:10080/NhinConnect/EntityDocRetrieve</con:value></con:property><con:property><con:name>SUT.MpiManagerEndpoint</con:name><con:value>http://192.168.25.157:8080/AdapterMpiManagerService/MpiManager</con:value></con:property><con:property><con:name>SUT.AdapterMpiEndpoint</con:name><con:value>http://192.168.25.157:9080/NhinConnect/AdapterMpiService</con:value></con:property><con:property><con:name>SUT.AdapterDocRetrieveEndpoint</con:name><con:value>http://dvanhie3.fedsconnect.org:9080/NhinConnect/AdapterDocRetrieve</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="transfer" name="set doc retrieve endpoint URL"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" disabled="false" entitize="false" transferChildNodes="false"><con:name>endpointTransfer1</con:name><con:sourceType>SUT.AdapterDocRetrieveEndpoint</con:sourceType><con:sourceStep>Test Case Properties</con:sourceStep><con:targetType>Endpoint</con:targetType><con:targetStep>RespondingGateway_CrossGatewayRetrieve</con:targetStep></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="get Dates"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );

sdf = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'");
sdf.setTimeZone(TimeZone.getTimeZone("UTC"));

sdf2 = new java.text.SimpleDateFormat("MM/dd/yyyy' 'HH:mm:ss");
sdf2.setTimeZone(TimeZone.getTimeZone("UTC"));

Calendar cal = new GregorianCalendar();
nowDate = new Date();

cal.setTime(nowDate);
cal.add(Calendar.MINUTE, -5);
startDate = cal.getTime();
startDateStr = sdf.format(startDate);
sigDateStr = sdf2.format(startDate);

cal.setTime(nowDate);
cal.add(Calendar.MINUTE, 5);
endDate = cal.getTime();
endDateStr = sdf.format(endDate);

cal.setTime(nowDate);
cal.add(Calendar.DATE, 30);
expireDate = cal.getTime();
expireDateStr = sdf2.format(expireDate);

groovyUtils.setPropertyValue( "Date Properties", "startDate", startDateStr);
groovyUtils.setPropertyValue( "Date Properties", "endDate", endDateStr);
groovyUtils.setPropertyValue( "Date Properties", "sigDate", sigDateStr);
groovyUtils.setPropertyValue( "Date Properties", "expireDate", expireDateStr);
</script></con:config></con:testStep><con:testStep type="properties" name="Date Properties"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>startDate</con:name><con:value>2009-03-16T16:38:53Z</con:value></con:property><con:property><con:name>endDate</con:name><con:value>2009-03-16T16:48:53Z</con:value></con:property><con:property><con:name>sigDate</con:name><con:value>03/16/2009 16:38:53</con:value></con:property><con:property><con:name>expireDate</con:name><con:value>04/15/2009 16:43:53</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="datasource" name="Doc Retrieve Spreadsheet"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Excel"><con:configuration><file>C:/projects/NHINC/Current/Product/IntegrationTest/DocRetrieveTests.xls</file><worksheet>Doc Not Found</worksheet><cell>A1</cell><ignoreEmpty>false</ignoreEmpty></con:configuration></con:dataSource><con:property>HomeCommunityId</con:property><con:property>RepositoryUniqueId</con:property><con:property>DocumentUniqueId</con:property><con:startRow>1</con:startRow><con:endRow/><con:trimValues>false</con:trimValues><con:entitizeValues>false</con:entitizeValues><con:restartOnRun>true</con:restartOnRun><con:expandProperties>false</con:expandProperties></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" entitize="false" transferChildNodes="false"><con:name>HomeCommunityId</con:name><con:sourceType>HomeCommunityId</con:sourceType><con:sourceStep>Doc Retrieve Spreadsheet</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>RespondingGateway_CrossGatewayRetrieve</con:targetStep><con:targetPath>declare namespace ns13='urn:ihe:iti:xds-b:2007';
declare namespace ns1='urn:gov:hhs:fha:nhinc:common:nhinccommonadapter';
//ns1:RespondingGateway_CrossGatewayRetrieveRequest[1]/ns13:RetrieveDocumentSetRequest[1]/ns13:DocumentRequest[1]/ns13:HomeCommunityId[1]</con:targetPath></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true"><con:name>RepositoryUniqueId</con:name><con:sourceType>RepositoryUniqueId</con:sourceType><con:sourceStep>Doc Retrieve Spreadsheet</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>RespondingGateway_CrossGatewayRetrieve</con:targetStep><con:targetPath>declare namespace ns13='urn:ihe:iti:xds-b:2007';
declare namespace ns1='urn:gov:hhs:fha:nhinc:common:nhinccommonadapter';
//ns1:RespondingGateway_CrossGatewayRetrieveRequest[1]/ns13:RetrieveDocumentSetRequest[1]/ns13:DocumentRequest[1]/ns13:RepositoryUniqueId[1]</con:targetPath></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true"><con:name>DocumentUniqueId</con:name><con:sourceType>DocumentUniqueId</con:sourceType><con:sourceStep>Doc Retrieve Spreadsheet</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>RespondingGateway_CrossGatewayRetrieve</con:targetStep><con:targetPath>declare namespace ns13='urn:ihe:iti:xds-b:2007';
declare namespace ns1='urn:gov:hhs:fha:nhinc:common:nhinccommonadapter';
//ns1:RespondingGateway_CrossGatewayRetrieveRequest[1]/ns13:RetrieveDocumentSetRequest[1]/ns13:DocumentRequest[1]/ns13:DocumentUniqueId[1]</con:targetPath></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true"><con:name>sigDate</con:name><con:sourceType>sigDate</con:sourceType><con:sourceStep>Date Properties</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>RespondingGateway_CrossGatewayRetrieve</con:targetStep><con:targetPath>declare namespace ns6='urn:gov:hhs:fha:nhinc:common:nhinccommon';
declare namespace ns1='urn:gov:hhs:fha:nhinc:common:nhinccommonadapter';
//ns1:RespondingGateway_CrossGatewayRetrieveRequest[1]/ns1:assertion[1]/ns6:dateOfSignature[1]</con:targetPath></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" entitize="false" transferChildNodes="false"><con:name>expireDate</con:name><con:sourceType>expireDate</con:sourceType><con:sourceStep>Date Properties</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>RespondingGateway_CrossGatewayRetrieve</con:targetStep><con:targetPath>declare namespace ns6='urn:gov:hhs:fha:nhinc:common:nhinccommon';
declare namespace ns1='urn:gov:hhs:fha:nhinc:common:nhinccommonadapter';
//ns1:RespondingGateway_CrossGatewayRetrieveRequest[1]/ns1:assertion[1]/ns6:expirationDate[1]</con:targetPath></con:transfers></con:config></con:testStep><con:testStep type="request" name="RespondingGateway_CrossGatewayRetrieve"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AdapterDocRetrieveBindingSoap11</con:interface><con:operation>RespondingGateway_CrossGatewayRetrieve</con:operation><con:request name="RespondingGateway_CrossGatewayRetrieve"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://dvanhie3.fedsconnect.org:9080/NhinConnect/AdapterDocRetrieve</con:endpoint><con:request><![CDATA[<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
   <SOAP-ENV:Header/>
   <SOAP-ENV:Body>
      <ns1:RespondingGateway_CrossGatewayRetrieveRequest xmlns:msgns="urn:gov:hhs:fha:nhinc:adapterdocretrieve" xmlns:ns1="urn:gov:hhs:fha:nhinc:common:nhinccommonadapter">
         <ns0:RetrieveDocumentSetRequest xmlns:S="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns0="urn:ihe:iti:xds-b:2007" xmlns:ns10="http://docs.oasis-open.org/wsn/b-2" xmlns:ns11="http://docs.oasis-open.org/wsrf/bf-2" xmlns:ns12="http://nhinc.services.com/schema/auditmessage" xmlns:ns13="urn:ihe:iti:xds-b:2007" xmlns:ns14="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:ns2="http://docs.oasis-open.org/wsn/t-1" xmlns:ns3="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0" xmlns:ns4="urn:oasis:names:tc:ebxml-regrep:xsd:rs:3.0" xmlns:ns5="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:ns6="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:ns7="urn:gov:hhs:fha:nhinc:common:nhinccommoninternalorch" xmlns:ns8="urn:oasis:names:tc:ebxml-regrep:xsd:lcm:3.0" xmlns:ns9="http://www.w3.org/2005/08/addressing">
            <ns13:DocumentRequest>
               <ns13:HomeCommunityId>urn:oid:2.16.840.1.113883.3.201</ns13:HomeCommunityId>
               <ns13:RepositoryUniqueId>1</ns13:RepositoryUniqueId>
               <ns13:DocumentUniqueId>111111111</ns13:DocumentUniqueId>
            </ns13:DocumentRequest>
         </ns0:RetrieveDocumentSetRequest>
         <ns1:assertion xmlns:S="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns10="http://docs.oasis-open.org/wsn/b-2" xmlns:ns11="http://docs.oasis-open.org/wsrf/bf-2" xmlns:ns12="http://nhinc.services.com/schema/auditmessage" xmlns:ns13="urn:ihe:iti:xds-b:2007" xmlns:ns14="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:ns2="http://docs.oasis-open.org/wsn/t-1" xmlns:ns3="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0" xmlns:ns4="urn:oasis:names:tc:ebxml-regrep:xsd:rs:3.0" xmlns:ns5="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:ns6="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:ns7="urn:gov:hhs:fha:nhinc:common:nhinccommoninternalorch" xmlns:ns8="urn:oasis:names:tc:ebxml-regrep:xsd:lcm:3.0" xmlns:ns9="http://www.w3.org/2005/08/addressing">
            <ns6:dateOfSignature>03/16/2009 16:38:53</ns6:dateOfSignature>
            <ns6:expirationDate>04/15/2009 16:43:53</ns6:expirationDate>
            <ns6:haveSecondWitnessSignature>false</ns6:haveSecondWitnessSignature>
            <ns6:haveSignature>false</ns6:haveSignature>
            <ns6:haveWitnessSignature>false</ns6:haveWitnessSignature>
            <ns6:userInfo>
               <ns6:personName>
                  <ns6:familyName>FRANKLIN</ns6:familyName>
                  <ns6:givenName>MARK</ns6:givenName>
                  <ns6:secondNameOrInitials>ALAN</ns6:secondNameOrInitials>
               </ns6:personName>
               <ns6:userName>mfranklin</ns6:userName>
               <ns6:org>
                  <ns6:name>Federal - DoD</ns6:name>
               </ns6:org>
               <ns6:roleCoded>
                  <ns6:code>80584001</ns6:code>
                  <ns6:codeSystem>2.16.840.1.113883.6.96</ns6:codeSystem>
                  <ns6:codeSystemName>SNOMED_CT</ns6:codeSystemName>
                  <ns6:displayName>Psychiatrist</ns6:displayName>
               </ns6:roleCoded>
            </ns6:userInfo>
            <ns6:authorized>false</ns6:authorized>
            <ns6:purposeOfDisclosureCoded>
               <ns6:code>PSYCHOTHERAPY</ns6:code>
               <ns6:codeSystem>2.16.840.1.113883.3.18.7.1</ns6:codeSystem>
               <ns6:codeSystemName>nhin-purpose</ns6:codeSystemName>
               <ns6:displayName>Use or disclosure of Psychotherapy Notes</ns6:displayName>
            </ns6:purposeOfDisclosureCoded>
            <ns6:claimFormRef>Ref-Clm-123</ns6:claimFormRef>
            <ns6:claimFormRaw>YWVvbGlhbQ==</ns6:claimFormRaw>
         </ns1:assertion>
      </ns1:RespondingGateway_CrossGatewayRetrieveRequest>
   </SOAP-ENV:Body>
</SOAP-ENV:Envelope>]]></con:request><con:assertion type="SOAP Fault Assertion"/><con:assertion type="SOAP Response"/><con:assertion type="GroovyScriptAssertion" name="Doc Data Present"><con:configuration><scriptText>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def holder = groovyUtils.getXmlHolder( messageExchange.responseContent )
def docData = holder["//ns5:RetrieveDocumentSetResponse[1]/ns5:DocumentResponse[1]/ns5:Document[1]"]

assert (docData.size() == 0)
</scriptText></con:configuration></con:assertion><con:assertion type="XPath Match" name="RegistryResponse Status Match"><con:configuration><path>declare namespace ns1='urn:ihe:iti:xds-b:2007';
declare namespace ns2='urn:oasis:names:tc:ebxml-regrep:xsd:rs:3.0';
//ns1:RetrieveDocumentSetResponse[1]/ns2:RegistryResponse[1]/@status</path><content>urn:oasis:names:tc:ebxml-regrep:ResponseStatusType:Failure</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences></con:configuration></con:assertion><con:assertion type="Simple NotContains" name="HomeCommunityId Absent"><con:configuration><token>HomeCommunityId</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple NotContains" name="RepositoryUniqueId Absent"><con:configuration><token>RepositoryUniqueId</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple NotContains" name="DocumentUniqueId Absent"><con:configuration><token>DocumentUniqueId</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:wsaConfig action="urn:gov:hhs:fha:nhinc:adapterdocretrieve/AdapterDocRetrievePortType/RespondingGateway_CrossGatewayRetrieveRequest" mustUnderstand="NONE" version="200508"/></con:request></con:config></con:testStep><con:testStep type="datasourceloop" name="Doc Retrieve Loop"><con:settings/><con:config><dataSourceStep>Doc Retrieve Spreadsheet</dataSourceStep><targetStep>Property Transfer</targetStep></con:config></con:testStep><con:properties/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Simple Retrieve" searchProperties="true" id="fcf3bff5-54f9-48a6-8fe6-893c353ea06a"><con:settings/><con:testStep type="properties" name="Test Case Properties"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:source>C:/projects/nhinc/Current/Product/IntegrationTest/default.properties</con:source><con:properties><con:property><con:name>SUT.PatientCorrelationFacade</con:name><con:value>http://172.16.50.82:9080/PatientCorrelationFacadeService</con:value></con:property><con:property><con:name>SUT.PatientCorrelationHost</con:name><con:value>192.168.25.157</con:value></con:property><con:property><con:name>SUT.PatientCorrelationPort</con:name><con:value>3306</con:value></con:property><con:property><con:name>SUT.PatientCorrelationDB</con:name><con:value>patientcorrelationdb</con:value></con:property><con:property><con:name>SUT.PatientCorrelationUser</con:name><con:value>epcuser</con:value></con:property><con:property><con:name>SUT.PatientCorrelationPass</con:name><con:value>epcpass</con:value></con:property><con:property><con:name>SUT.PatientCorrelationTable</con:name><con:value>correlatedidentifiers</con:value></con:property><con:property><con:name>SUT.PatientCorrelation</con:name><con:value>http://172.16.50.82:9080/PatientCorrelationService</con:value></con:property><con:property><con:name>SUT.EntityEndpoint</con:name><con:value>http://mhsnhie2.fedsconnect.org:18181/EntityServiceService/EntityServicePort</con:value></con:property><con:property><con:name>SUT.RemoteMPI</con:name><con:value>//192.168.25.157/glassfish/domains/domain1/config/mpi.xml</con:value></con:property><con:property><con:name>SUT.LocalMPI</con:name><con:value>//192.168.25.157/glassfish/domains/domain1/config/mpi.xml</con:value></con:property><con:property><con:name>SUT.EntityDocQueryEndpoint</con:name><con:value>http://192.168.25.157:10080/NhinConnect/EntityDocQuery</con:value></con:property><con:property><con:name>SUT.EntityDocRetrieveEndpoint</con:name><con:value>http://192.168.25.157:10080/NhinConnect/EntityDocRetrieve</con:value></con:property><con:property><con:name>SUT.MpiManagerEndpoint</con:name><con:value>http://192.168.25.157:8080/AdapterMpiManagerService/MpiManager</con:value></con:property><con:property><con:name>SUT.AdapterMpiEndpoint</con:name><con:value>http://192.168.25.157:9080/NhinConnect/AdapterMpiService</con:value></con:property><con:property><con:name>SUT.AdapterDocRetrieveEndpoint</con:name><con:value>http://dvanhie3.fedsconnect.org:9080/NhinConnect/AdapterDocRetrieve</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="transfer" name="set doc retrieve endpoint URL"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" disabled="false" entitize="false" transferChildNodes="false"><con:name>endpointTransfer1</con:name><con:sourceType>SUT.AdapterDocRetrieveEndpoint</con:sourceType><con:sourceStep>Test Case Properties</con:sourceStep><con:targetType>Endpoint</con:targetType><con:targetStep>RespondingGateway_CrossGatewayRetrieve</con:targetStep></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="get Dates"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );

sdf = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'");
sdf.setTimeZone(TimeZone.getTimeZone("UTC"));

sdf2 = new java.text.SimpleDateFormat("MM/dd/yyyy' 'HH:mm:ss");
sdf2.setTimeZone(TimeZone.getTimeZone("UTC"));

Calendar cal = new GregorianCalendar();
nowDate = new Date();

cal.setTime(nowDate);
cal.add(Calendar.MINUTE, -5);
startDate = cal.getTime();
startDateStr = sdf.format(startDate);
sigDateStr = sdf2.format(startDate);

cal.setTime(nowDate);
cal.add(Calendar.MINUTE, 5);
endDate = cal.getTime();
endDateStr = sdf.format(endDate);

cal.setTime(nowDate);
cal.add(Calendar.DATE, 30);
expireDate = cal.getTime();
expireDateStr = sdf2.format(expireDate);

groovyUtils.setPropertyValue( "Date Properties", "startDate", startDateStr);
groovyUtils.setPropertyValue( "Date Properties", "endDate", endDateStr);
groovyUtils.setPropertyValue( "Date Properties", "sigDate", sigDateStr);
groovyUtils.setPropertyValue( "Date Properties", "expireDate", expireDateStr);
</script></con:config></con:testStep><con:testStep type="properties" name="Date Properties"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>startDate</con:name><con:value>2009-03-16T16:38:53Z</con:value></con:property><con:property><con:name>endDate</con:name><con:value>2009-03-16T16:48:53Z</con:value></con:property><con:property><con:name>sigDate</con:name><con:value>03/16/2009 16:38:53</con:value></con:property><con:property><con:name>expireDate</con:name><con:value>04/15/2009 16:43:53</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="datasource" name="Doc Retrieve Spreadsheet"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Excel"><con:configuration><file>C:/projects/NHINC/Current/Product/IntegrationTest/DocRetrieveTests.xls</file><worksheet>Simple Retrieve</worksheet><cell>A1</cell><ignoreEmpty>false</ignoreEmpty></con:configuration></con:dataSource><con:property>HomeCommunityId</con:property><con:property>RepositoryUniqueId</con:property><con:property>DocumentUniqueId</con:property><con:startRow>1</con:startRow><con:endRow/><con:trimValues>false</con:trimValues><con:entitizeValues>false</con:entitizeValues><con:restartOnRun>true</con:restartOnRun><con:expandProperties>false</con:expandProperties></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" entitize="false" transferChildNodes="false"><con:name>HomeCommunityId</con:name><con:sourceType>HomeCommunityId</con:sourceType><con:sourceStep>Doc Retrieve Spreadsheet</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>RespondingGateway_CrossGatewayRetrieve</con:targetStep><con:targetPath>declare namespace ns13='urn:ihe:iti:xds-b:2007';
declare namespace ns1='urn:gov:hhs:fha:nhinc:common:nhinccommonadapter';
//ns1:RespondingGateway_CrossGatewayRetrieveRequest[1]/ns13:RetrieveDocumentSetRequest[1]/ns13:DocumentRequest[1]/ns13:HomeCommunityId[1]</con:targetPath></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true"><con:name>RepositoryUniqueId</con:name><con:sourceType>RepositoryUniqueId</con:sourceType><con:sourceStep>Doc Retrieve Spreadsheet</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>RespondingGateway_CrossGatewayRetrieve</con:targetStep><con:targetPath>declare namespace ns13='urn:ihe:iti:xds-b:2007';
declare namespace ns1='urn:gov:hhs:fha:nhinc:common:nhinccommonadapter';
//ns1:RespondingGateway_CrossGatewayRetrieveRequest[1]/ns13:RetrieveDocumentSetRequest[1]/ns13:DocumentRequest[1]/ns13:RepositoryUniqueId[1]</con:targetPath></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true"><con:name>DocumentUniqueId</con:name><con:sourceType>DocumentUniqueId</con:sourceType><con:sourceStep>Doc Retrieve Spreadsheet</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>RespondingGateway_CrossGatewayRetrieve</con:targetStep><con:targetPath>declare namespace ns13='urn:ihe:iti:xds-b:2007';
declare namespace ns1='urn:gov:hhs:fha:nhinc:common:nhinccommonadapter';
//ns1:RespondingGateway_CrossGatewayRetrieveRequest[1]/ns13:RetrieveDocumentSetRequest[1]/ns13:DocumentRequest[1]/ns13:DocumentUniqueId[1]</con:targetPath></con:transfers></con:config></con:testStep><con:testStep type="request" name="RespondingGateway_CrossGatewayRetrieve"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AdapterDocRetrieveBindingSoap11</con:interface><con:operation>RespondingGateway_CrossGatewayRetrieve</con:operation><con:request name="RespondingGateway_CrossGatewayRetrieve"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://dvanhie3.fedsconnect.org:9080/NhinConnect/AdapterDocRetrieve</con:endpoint><con:request><![CDATA[<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
   <SOAP-ENV:Header/>
   <SOAP-ENV:Body>
      <ns1:RespondingGateway_CrossGatewayRetrieveRequest xmlns:msgns="urn:gov:hhs:fha:nhinc:adapterdocretrieve" xmlns:ns1="urn:gov:hhs:fha:nhinc:common:nhinccommonadapter">
         <ns0:RetrieveDocumentSetRequest xmlns:S="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns0="urn:ihe:iti:xds-b:2007" xmlns:ns10="http://docs.oasis-open.org/wsn/b-2" xmlns:ns11="http://docs.oasis-open.org/wsrf/bf-2" xmlns:ns12="http://nhinc.services.com/schema/auditmessage" xmlns:ns13="urn:ihe:iti:xds-b:2007" xmlns:ns14="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:ns2="http://docs.oasis-open.org/wsn/t-1" xmlns:ns3="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0" xmlns:ns4="urn:oasis:names:tc:ebxml-regrep:xsd:rs:3.0" xmlns:ns5="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:ns6="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:ns7="urn:gov:hhs:fha:nhinc:common:nhinccommoninternalorch" xmlns:ns8="urn:oasis:names:tc:ebxml-regrep:xsd:lcm:3.0" xmlns:ns9="http://www.w3.org/2005/08/addressing">
            <ns13:DocumentRequest>
               <ns13:HomeCommunityId>urn:oid:2.16.840.1.113883.3.200</ns13:HomeCommunityId>
               <ns13:RepositoryUniqueId>1</ns13:RepositoryUniqueId>
               <ns13:DocumentUniqueId>555555555</ns13:DocumentUniqueId>
            </ns13:DocumentRequest>
         </ns0:RetrieveDocumentSetRequest>
         <ns1:assertion xmlns:S="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns10="http://docs.oasis-open.org/wsn/b-2" xmlns:ns11="http://docs.oasis-open.org/wsrf/bf-2" xmlns:ns12="http://nhinc.services.com/schema/auditmessage" xmlns:ns13="urn:ihe:iti:xds-b:2007" xmlns:ns14="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:ns2="http://docs.oasis-open.org/wsn/t-1" xmlns:ns3="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0" xmlns:ns4="urn:oasis:names:tc:ebxml-regrep:xsd:rs:3.0" xmlns:ns5="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:ns6="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:ns7="urn:gov:hhs:fha:nhinc:common:nhinccommoninternalorch" xmlns:ns8="urn:oasis:names:tc:ebxml-regrep:xsd:lcm:3.0" xmlns:ns9="http://www.w3.org/2005/08/addressing">
            <ns6:dateOfSignature>02/20/2009 01:00:00</ns6:dateOfSignature>
            <ns6:expirationDate>02/20/2010 01:00:00</ns6:expirationDate>
            <ns6:haveSecondWitnessSignature>false</ns6:haveSecondWitnessSignature>
            <ns6:haveSignature>false</ns6:haveSignature>
            <ns6:haveWitnessSignature>false</ns6:haveWitnessSignature>
            <ns6:userInfo>
               <ns6:personName>
                  <ns6:familyName>FRANKLIN</ns6:familyName>
                  <ns6:givenName>MARK</ns6:givenName>
                  <ns6:secondNameOrInitials>ALAN</ns6:secondNameOrInitials>
               </ns6:personName>
               <ns6:userName>mfranklin</ns6:userName>
               <ns6:org>
                  <ns6:name>Federal - DoD</ns6:name>
               </ns6:org>
               <ns6:roleCoded>
                  <ns6:code>80584001</ns6:code>
                  <ns6:codeSystem>2.16.840.1.113883.6.96</ns6:codeSystem>
                  <ns6:codeSystemName>SNOMED_CT</ns6:codeSystemName>
                  <ns6:displayName>Psychiatrist</ns6:displayName>
               </ns6:roleCoded>
            </ns6:userInfo>
            <ns6:authorized>false</ns6:authorized>
            <ns6:purposeOfDisclosureCoded>
               <ns6:code>PSYCHOTHERAPY</ns6:code>
               <ns6:codeSystem>2.16.840.1.113883.3.18.7.1</ns6:codeSystem>
               <ns6:codeSystemName>nhin-purpose</ns6:codeSystemName>
               <ns6:displayName>Use or disclosure of Psychotherapy Notes</ns6:displayName>
            </ns6:purposeOfDisclosureCoded>
            <ns6:claimFormRef>Ref-Clm-123</ns6:claimFormRef>
            <ns6:claimFormRaw>YWVvbGlhbQ==</ns6:claimFormRaw>
         </ns1:assertion>
      </ns1:RespondingGateway_CrossGatewayRetrieveRequest>
   </SOAP-ENV:Body>
</SOAP-ENV:Envelope>]]></con:request><con:assertion type="SOAP Fault Assertion"/><con:assertion type="SOAP Response"/><con:assertion type="XPath Match" name="HCID Match"><con:configuration><path>declare namespace ns5='urn:ihe:iti:xds-b:2007';
//ns5:RetrieveDocumentSetResponse[1]/ns5:DocumentResponse[1]/ns5:HomeCommunityId[1]</path><content>${Doc Retrieve Spreadsheet#HomeCommunityId}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences></con:configuration></con:assertion><con:assertion type="XPath Match" name="Repository ID Match"><con:configuration><path>declare namespace ns5='urn:ihe:iti:xds-b:2007';
//ns5:RetrieveDocumentSetResponse[1]/ns5:DocumentResponse[1]/ns5:RepositoryUniqueId[1]</path><content>${Doc Retrieve Spreadsheet#RepositoryUniqueId}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences></con:configuration></con:assertion><con:assertion type="XPath Match" name="Document ID Match"><con:configuration><path>declare namespace ns5='urn:ihe:iti:xds-b:2007';
//ns5:RetrieveDocumentSetResponse[1]/ns5:DocumentResponse[1]/ns5:DocumentUniqueId[1]</path><content>${Doc Retrieve Spreadsheet#DocumentUniqueId}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" name="Doc Data Present"><con:configuration><scriptText>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def holder = groovyUtils.getXmlHolder( messageExchange.responseContent )
def docData = holder["//ns5:RetrieveDocumentSetResponse[1]/ns5:DocumentResponse[1]/ns5:Document[1]"]
assert (docData.size() > 0)

</scriptText></con:configuration></con:assertion><con:assertion type="XPath Match" name="RegistryResponse Status Match"><con:configuration><path>declare namespace ns1='urn:ihe:iti:xds-b:2007';
declare namespace ns2='urn:oasis:names:tc:ebxml-regrep:xsd:rs:3.0';
//ns1:RetrieveDocumentSetResponse[1]/ns2:RegistryResponse[1]/@status</path><content>urn:oasis:names:tc:ebxml-regrep:ResponseStatusType:Success</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences></con:configuration></con:assertion><con:wsaConfig action="urn:gov:hhs:fha:nhinc:adapterdocretrieve/AdapterDocRetrievePortType/RespondingGateway_CrossGatewayRetrieveRequest" mustUnderstand="NONE" version="200508"/></con:request></con:config></con:testStep><con:testStep type="datasourceloop" name="Doc Retrieve Loop"><con:settings/><con:config><dataSourceStep>Doc Retrieve Spreadsheet</dataSourceStep><targetStep>Property Transfer</targetStep></con:config></con:testStep><con:properties/></con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Missing HCID Prefix" searchProperties="true" id="3d2b0534-ab57-4ed6-be80-f57db11217e1"><con:settings/><con:testStep type="properties" name="Test Case Properties"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:source>C:/projects/nhinc/Current/Product/IntegrationTest/default.properties</con:source><con:properties><con:property><con:name>SUT.PatientCorrelationFacade</con:name><con:value>http://172.16.50.82:9080/PatientCorrelationFacadeService</con:value></con:property><con:property><con:name>SUT.PatientCorrelationHost</con:name><con:value>192.168.25.157</con:value></con:property><con:property><con:name>SUT.PatientCorrelationPort</con:name><con:value>3306</con:value></con:property><con:property><con:name>SUT.PatientCorrelationDB</con:name><con:value>patientcorrelationdb</con:value></con:property><con:property><con:name>SUT.PatientCorrelationUser</con:name><con:value>epcuser</con:value></con:property><con:property><con:name>SUT.PatientCorrelationPass</con:name><con:value>epcpass</con:value></con:property><con:property><con:name>SUT.PatientCorrelationTable</con:name><con:value>correlatedidentifiers</con:value></con:property><con:property><con:name>SUT.PatientCorrelation</con:name><con:value>http://172.16.50.82:9080/PatientCorrelationService</con:value></con:property><con:property><con:name>SUT.EntityEndpoint</con:name><con:value>http://mhsnhie2.fedsconnect.org:18181/EntityServiceService/EntityServicePort</con:value></con:property><con:property><con:name>SUT.RemoteMPI</con:name><con:value>//192.168.25.157/glassfish/domains/domain1/config/mpi.xml</con:value></con:property><con:property><con:name>SUT.LocalMPI</con:name><con:value>//192.168.25.157/glassfish/domains/domain1/config/mpi.xml</con:value></con:property><con:property><con:name>SUT.EntityDocQueryEndpoint</con:name><con:value>http://192.168.25.157:9080/NhinConnect/EntityDocQuery</con:value></con:property><con:property><con:name>SUT.EntityDocRetrieveEndpoint</con:name><con:value>http://mhsnhie3.fedsconnect.org:9080/NhinConnect/EntityDocRetrieve</con:value></con:property><con:property><con:name>SUT.MpiManagerEndpoint</con:name><con:value>http://192.168.25.157:8080/AdapterMpiManagerService/MpiManager</con:value></con:property><con:property><con:name>SUT.AdapterMpiEndpoint</con:name><con:value>http://192.168.25.157:9080/NhinConnect/AdapterMpiService</con:value></con:property><con:property><con:name>SUT.AdapterDocRetrieveEndpoint</con:name><con:value>http://dvanhie3.fedsconnect.org:9080/NhinConnect/AdapterDocRetrieve</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="transfer" name="set doc retrieve endpoint URL"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" disabled="false" entitize="false" transferChildNodes="false"><con:name>endpointTransfer1</con:name><con:sourceType>SUT.AdapterDocRetrieveEndpoint</con:sourceType><con:sourceStep>Test Case Properties</con:sourceStep><con:targetType>Endpoint</con:targetType><con:targetStep>RespondingGateway_CrossGatewayRetrieve</con:targetStep></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="get Dates"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );

sdf = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'");
sdf.setTimeZone(TimeZone.getTimeZone("UTC"));

sdf2 = new java.text.SimpleDateFormat("MM/dd/yyyy' 'HH:mm:ss");
sdf2.setTimeZone(TimeZone.getTimeZone("UTC"));

Calendar cal = new GregorianCalendar();
nowDate = new Date();

cal.setTime(nowDate);
cal.add(Calendar.MINUTE, -5);
startDate = cal.getTime();
startDateStr = sdf.format(startDate);
sigDateStr = sdf2.format(startDate);

cal.setTime(nowDate);
cal.add(Calendar.MINUTE, 5);
endDate = cal.getTime();
endDateStr = sdf.format(endDate);

cal.setTime(nowDate);
cal.add(Calendar.DATE, 30);
expireDate = cal.getTime();
expireDateStr = sdf2.format(expireDate);

groovyUtils.setPropertyValue( "Date Properties", "startDate", startDateStr);
groovyUtils.setPropertyValue( "Date Properties", "endDate", endDateStr);
groovyUtils.setPropertyValue( "Date Properties", "sigDate", sigDateStr);
groovyUtils.setPropertyValue( "Date Properties", "expireDate", expireDateStr);
</script></con:config></con:testStep><con:testStep type="properties" name="Date Properties"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>startDate</con:name><con:value>2009-03-16T21:51:45Z</con:value></con:property><con:property><con:name>endDate</con:name><con:value>2009-03-16T22:01:45Z</con:value></con:property><con:property><con:name>sigDate</con:name><con:value>03/16/2009 21:51:45</con:value></con:property><con:property><con:name>expireDate</con:name><con:value>04/15/2009 21:56:45</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="datasource" name="Doc Retrieve Spreadsheet"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Excel"><con:configuration><file>C:/projects/NHINC/Current/Product/IntegrationTest/DocRetrieveTests.xls</file><worksheet>Missing HCID Prefix</worksheet><cell>A1</cell><ignoreEmpty>false</ignoreEmpty></con:configuration></con:dataSource><con:property>HomeCommunityId</con:property><con:property>RepositoryUniqueId</con:property><con:property>DocumentUniqueId</con:property><con:startRow>1</con:startRow><con:endRow/><con:trimValues>false</con:trimValues><con:entitizeValues>false</con:entitizeValues><con:restartOnRun>true</con:restartOnRun><con:expandProperties>false</con:expandProperties></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" entitize="false" transferChildNodes="false"><con:name>HomeCommunityId</con:name><con:sourceType>HomeCommunityId</con:sourceType><con:sourceStep>Doc Retrieve Spreadsheet</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>RespondingGateway_CrossGatewayRetrieve</con:targetStep><con:targetPath>declare namespace ns13='urn:ihe:iti:xds-b:2007';
declare namespace ns1='urn:gov:hhs:fha:nhinc:common:nhinccommonadapter';
//ns1:RespondingGateway_CrossGatewayRetrieveRequest[1]/ns13:RetrieveDocumentSetRequest[1]/ns13:DocumentRequest[1]/ns13:HomeCommunityId[1]</con:targetPath></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true"><con:name>RepositoryUniqueId</con:name><con:sourceType>RepositoryUniqueId</con:sourceType><con:sourceStep>Doc Retrieve Spreadsheet</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>RespondingGateway_CrossGatewayRetrieve</con:targetStep><con:targetPath>declare namespace ns13='urn:ihe:iti:xds-b:2007';
declare namespace ns1='urn:gov:hhs:fha:nhinc:common:nhinccommonadapter';
//ns1:RespondingGateway_CrossGatewayRetrieveRequest[1]/ns13:RetrieveDocumentSetRequest[1]/ns13:DocumentRequest[1]/ns13:RepositoryUniqueId[1]</con:targetPath></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true"><con:name>DocumentUniqueId</con:name><con:sourceType>DocumentUniqueId</con:sourceType><con:sourceStep>Doc Retrieve Spreadsheet</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>RespondingGateway_CrossGatewayRetrieve</con:targetStep><con:targetPath>declare namespace ns13='urn:ihe:iti:xds-b:2007';
declare namespace ns1='urn:gov:hhs:fha:nhinc:common:nhinccommonadapter';
//ns1:RespondingGateway_CrossGatewayRetrieveRequest[1]/ns13:RetrieveDocumentSetRequest[1]/ns13:DocumentRequest[1]/ns13:DocumentUniqueId[1]</con:targetPath></con:transfers></con:config></con:testStep><con:testStep type="request" name="RespondingGateway_CrossGatewayRetrieve"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AdapterDocRetrieveBindingSoap11</con:interface><con:operation>RespondingGateway_CrossGatewayRetrieve</con:operation><con:request name="RespondingGateway_CrossGatewayRetrieve"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://dvanhie3.fedsconnect.org:9080/NhinConnect/AdapterDocRetrieve</con:endpoint><con:request><![CDATA[<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
   <SOAP-ENV:Header/>
   <SOAP-ENV:Body>
      <ns1:RespondingGateway_CrossGatewayRetrieveRequest xmlns:msgns="urn:gov:hhs:fha:nhinc:adapterdocretrieve" xmlns:ns1="urn:gov:hhs:fha:nhinc:common:nhinccommonadapter">
         <ns0:RetrieveDocumentSetRequest xmlns:S="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns0="urn:ihe:iti:xds-b:2007" xmlns:ns10="http://docs.oasis-open.org/wsn/b-2" xmlns:ns11="http://docs.oasis-open.org/wsrf/bf-2" xmlns:ns12="http://nhinc.services.com/schema/auditmessage" xmlns:ns13="urn:ihe:iti:xds-b:2007" xmlns:ns14="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:ns2="http://docs.oasis-open.org/wsn/t-1" xmlns:ns3="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0" xmlns:ns4="urn:oasis:names:tc:ebxml-regrep:xsd:rs:3.0" xmlns:ns5="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:ns6="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:ns7="urn:gov:hhs:fha:nhinc:common:nhinccommoninternalorch" xmlns:ns8="urn:oasis:names:tc:ebxml-regrep:xsd:lcm:3.0" xmlns:ns9="http://www.w3.org/2005/08/addressing">
            <ns13:DocumentRequest>
               <ns13:HomeCommunityId>2.16.840.1.113883.3.200</ns13:HomeCommunityId>
               <ns13:RepositoryUniqueId>1</ns13:RepositoryUniqueId>
               <ns13:DocumentUniqueId>555555555</ns13:DocumentUniqueId>
            </ns13:DocumentRequest>
         </ns0:RetrieveDocumentSetRequest>
         <ns1:assertion xmlns:S="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns10="http://docs.oasis-open.org/wsn/b-2" xmlns:ns11="http://docs.oasis-open.org/wsrf/bf-2" xmlns:ns12="http://nhinc.services.com/schema/auditmessage" xmlns:ns13="urn:ihe:iti:xds-b:2007" xmlns:ns14="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:ns2="http://docs.oasis-open.org/wsn/t-1" xmlns:ns3="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0" xmlns:ns4="urn:oasis:names:tc:ebxml-regrep:xsd:rs:3.0" xmlns:ns5="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:ns6="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:ns7="urn:gov:hhs:fha:nhinc:common:nhinccommoninternalorch" xmlns:ns8="urn:oasis:names:tc:ebxml-regrep:xsd:lcm:3.0" xmlns:ns9="http://www.w3.org/2005/08/addressing">
            <ns6:dateOfSignature>02/20/2009 01:00:00</ns6:dateOfSignature>
            <ns6:expirationDate>02/20/2010 01:00:00</ns6:expirationDate>
            <ns6:haveSecondWitnessSignature>false</ns6:haveSecondWitnessSignature>
            <ns6:haveSignature>false</ns6:haveSignature>
            <ns6:haveWitnessSignature>false</ns6:haveWitnessSignature>
            <ns6:userInfo>
               <ns6:personName>
                  <ns6:familyName>FRANKLIN</ns6:familyName>
                  <ns6:givenName>MARK</ns6:givenName>
                  <ns6:secondNameOrInitials>ALAN</ns6:secondNameOrInitials>
               </ns6:personName>
               <ns6:userName>mfranklin</ns6:userName>
               <ns6:org>
                  <ns6:name>Federal - DoD</ns6:name>
               </ns6:org>
               <ns6:roleCoded>
                  <ns6:code>80584001</ns6:code>
                  <ns6:codeSystem>2.16.840.1.113883.6.96</ns6:codeSystem>
                  <ns6:codeSystemName>SNOMED_CT</ns6:codeSystemName>
                  <ns6:displayName>Psychiatrist</ns6:displayName>
               </ns6:roleCoded>
            </ns6:userInfo>
            <ns6:authorized>false</ns6:authorized>
            <ns6:purposeOfDisclosureCoded>
               <ns6:code>PSYCHOTHERAPY</ns6:code>
               <ns6:codeSystem>2.16.840.1.113883.3.18.7.1</ns6:codeSystem>
               <ns6:codeSystemName>nhin-purpose</ns6:codeSystemName>
               <ns6:displayName>Use or disclosure of Psychotherapy Notes</ns6:displayName>
            </ns6:purposeOfDisclosureCoded>
            <ns6:claimFormRef>Ref-Clm-123</ns6:claimFormRef>
            <ns6:claimFormRaw>YWVvbGlhbQ==</ns6:claimFormRaw>
         </ns1:assertion>
      </ns1:RespondingGateway_CrossGatewayRetrieveRequest>
   </SOAP-ENV:Body>
</SOAP-ENV:Envelope>]]></con:request><con:assertion type="SOAP Fault Assertion"/><con:assertion type="SOAP Response"/><con:assertion type="XPath Match" name="HCID Match"><con:configuration><path>declare namespace ns5='urn:ihe:iti:xds-b:2007';
//ns5:RetrieveDocumentSetResponse[1]/ns5:DocumentResponse[1]/ns5:HomeCommunityId[1]</path><content>${Doc Retrieve Spreadsheet#HomeCommunityId}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences></con:configuration></con:assertion><con:assertion type="XPath Match" name="Repository ID Match"><con:configuration><path>declare namespace ns5='urn:ihe:iti:xds-b:2007';
//ns5:RetrieveDocumentSetResponse[1]/ns5:DocumentResponse[1]/ns5:RepositoryUniqueId[1]</path><content>${Doc Retrieve Spreadsheet#RepositoryUniqueId}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences></con:configuration></con:assertion><con:assertion type="XPath Match" name="Document ID Match"><con:configuration><path>declare namespace ns5='urn:ihe:iti:xds-b:2007';
//ns5:RetrieveDocumentSetResponse[1]/ns5:DocumentResponse[1]/ns5:DocumentUniqueId[1]</path><content>${Doc Retrieve Spreadsheet#DocumentUniqueId}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" name="Doc Data Present"><con:configuration><scriptText>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def holder = groovyUtils.getXmlHolder( messageExchange.responseContent )
def docData = holder["//ns5:RetrieveDocumentSetResponse[1]/ns5:DocumentResponse[1]/ns5:Document[1]"]
assert (docData.size() > 0)

</scriptText></con:configuration></con:assertion><con:assertion type="XPath Match" name="RegistryResponse Status Match"><con:configuration><path>declare namespace ns1='urn:ihe:iti:xds-b:2007';
declare namespace ns2='urn:oasis:names:tc:ebxml-regrep:xsd:rs:3.0';
//ns1:RetrieveDocumentSetResponse[1]/ns2:RegistryResponse[1]/@status</path><content>urn:oasis:names:tc:ebxml-regrep:ResponseStatusType:Success</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences></con:configuration></con:assertion><con:wsaConfig action="urn:gov:hhs:fha:nhinc:adapterdocretrieve/AdapterDocRetrievePortType/RespondingGateway_CrossGatewayRetrieveRequest" mustUnderstand="NONE" version="200508"/></con:request></con:config></con:testStep><con:testStep type="datasourceloop" name="Doc Retrieve Loop"><con:settings/><con:config><dataSourceStep>Doc Retrieve Spreadsheet</dataSourceStep><targetStep>Property Transfer</targetStep></con:config></con:testStep><con:properties/></con:testCase><con:properties/></con:testSuite><con:requirements/><con:properties/><con:wssContainer/></con:soapui-project>