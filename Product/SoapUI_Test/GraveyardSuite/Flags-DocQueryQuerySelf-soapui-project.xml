<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project name="Flags-DocQueryQuerySelf" resourceRoot="" soapui-version="4.0.0" abortOnError="false" runType="SEQUENTIAL" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:WsdlInterface" wsaVersion="NONE" name="EntityDocQueryBindingSoap11" type="wsdl" bindingName="{urn:gov:hhs:fha:nhinc:entitydocquery}EntityDocQueryBindingSoap11" soapVersion="1_1" anonymous="optional" definition="file:/C:/projects/NHINC/Current/Product/Production/Common/Interfaces/src/wsdl/EntityDocQuery.wsdl" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:endpoints><con:endpoint>http://localhost:${HttpDefaultPort}/NhinConnect/EntityDocQuery</con:endpoint></con:endpoints><con:operation isOneWay="false" action="urn:RespondingGateway_CrossGatewayQuery" name="RespondingGateway_CrossGatewayQuery" bindingOperationName="RespondingGateway_CrossGatewayQuery" type="Request-Response" outputName="RespondingGateway_CrossGatewayQueryResponse" inputName="RespondingGateway_CrossGatewayQueryRequest" receivesAttachments="false" sendsAttachments="false"><con:settings/></con:operation></con:interface><con:testSuite name="Document Query"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase failOnError="false" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="documentQueryQuerySelf = true" searchProperties="true" id="e13cfbb4-abe5-45a9-8790-47c5c7a2ad97" timeout="0"><con:settings/><con:testStep type="properties" name="Test Case Properties"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" createMissingOnLoad="true" discardValuesOnSave="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:source>C:/projects/nhinc/Current/Product/IntegrationTest/OutboundSelfTest.properties</con:source><con:properties><con:property><con:name>LocalHCID</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>LocalAA</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>Endpoint-Reidentification</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>PseudonymAA</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>PseudonymPatientID</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>RealAA</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>RealPatientID</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>NHINGatewayConfigDir</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>NHINAdapterConfigDir</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>LocalConfigDir</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>Endpoint-DocQuery</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>Endpoint-DocRetrieve</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>DQDocID</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>DRDocID</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>SubscriptionDir</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>MPIDir</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>Endpoint-SubjectDiscovery</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>Endpoint-Subscribe</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>Endpoint-Notify</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>Endpoint-Unsubscribe</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>Endpoint-AuditLogQuery</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>NotificationEndpoint</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>SubscribePatientID</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>NotifySubscriptionID</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>NotifySubscriptionManagerEndpointAddress</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>UnsubSubscriptionID</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>SubscriptionManagerEndpointAddress</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>LocalHCDescription</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>DQPatientID</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>FullPatientID</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>CorrectedLocalHCID</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>startDate</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>endDate</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>sigDate</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>expireDate</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>SDPatientID</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>AQUserID</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>AQPatientID</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>RemoteHCID</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>RemoteHCDescription</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>RevokePatientID</con:name><con:value xsi:nil="true"/></con:property><con:property><con:name>RemoteAA</con:name><con:value xsi:nil="true"/></con:property></con:properties></con:config></con:testStep><con:testStep type="groovy" name="get Dates"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );

sdf = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'");
sdf.setTimeZone(TimeZone.getTimeZone("UTC"));

sdf2 = new java.text.SimpleDateFormat("MM/dd/yyyy' 'HH:mm:ss");
sdf2.setTimeZone(TimeZone.getTimeZone("UTC"));

Calendar cal = new GregorianCalendar();
nowDate = new Date();

cal.setTime(nowDate);
cal.add(Calendar.MINUTE, -5);
startDate = cal.getTime();
startDateStr = sdf.format(startDate);
sigDateStr = sdf2.format(startDate);

cal.setTime(nowDate);
cal.add(Calendar.MINUTE, 5);
endDate = cal.getTime();
endDateStr = sdf.format(endDate);

cal.setTime(nowDate);
cal.add(Calendar.DATE, 30);
expireDate = cal.getTime();
expireDateStr = sdf2.format(expireDate);

groovyUtils.setPropertyValue( "Test Case Properties", "startDate", startDateStr);
groovyUtils.setPropertyValue( "Test Case Properties", "endDate", endDateStr);
groovyUtils.setPropertyValue( "Test Case Properties", "sigDate", sigDateStr);
groovyUtils.setPropertyValue( "Test Case Properties", "expireDate", expireDateStr);
</script></con:config></con:testStep><con:testStep type="groovy" name="Generate patient ID for Doc Query"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );
def propertyList = testRunner.testCase.getTestStepByName( "Test Case Properties" );
def LocalAA = propertyList.getPropertyValue( "LocalAA" );
def DQPatientID = propertyList.getPropertyValue( "DQPatientID" );

//fullPatientID = "'" + DQPatientID + "^^^&amp;" + LocalAA + "&amp;ISO'";
fullPatientID = DQPatientID + "^^^&amp;" + LocalAA + "&amp;ISO";
groovyUtils.setPropertyValue( "Test Case Properties", "FullPatientID", fullPatientID);
</script></con:config></con:testStep><con:testStep type="transfer" name="set doc query properties"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" entitize="false" transferChildNodes="false"><con:name>endpointTransfer</con:name><con:sourceType>Endpoint-DocQuery</con:sourceType><con:sourceStep>Test Case Properties</con:sourceStep><con:targetType>Endpoint</con:targetType><con:targetStep>Document Query</con:targetStep></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" entitize="false" transferChildNodes="false"><con:name>fullPatientID</con:name><con:sourceType>FullPatientID</con:sourceType><con:sourceStep>Test Case Properties</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Document Query</con:targetStep><con:targetPath>declare namespace urn2='urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0';
declare namespace urn1='urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0';
declare namespace urn='urn:gov:hhs:fha:nhinc:common:nhinccommonentity';
//urn:RespondingGateway_CrossGatewayQueryRequest[1]/urn1:AdhocQueryRequest[1]/urn2:AdhocQuery[1]/urn2:Slot[@name="$XDSDocumentEntryPatientId"]/urn2:ValueList[1]/urn2:Value[1]</con:targetPath></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" entitize="false" transferToAll="false" disabled="true"><con:name>targetHCID</con:name><con:sourceType>RemoteHCID</con:sourceType><con:sourceStep>Test Case Properties</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Document Query</con:targetStep><con:targetPath>declare namespace urn='urn:gov:hhs:fha:nhinc:common:nhinccommonentity';
declare namespace urn3='urn:gov:hhs:fha:nhinc:common:nhinccommon';
//urn:RespondingGateway_CrossGatewayQueryRequest[1]/urn:NhinTargetCommunities[1]/urn3:nhinTargetCommunity[1]/urn3:homeCommunity[1]/urn3:homeCommunityId[1]</con:targetPath></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" disabled="true"><con:name>targetDescription</con:name><con:sourceType>RemoteHCDescription</con:sourceType><con:sourceStep>Test Case Properties</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Document Query</con:targetStep><con:targetPath>declare namespace urn='urn:gov:hhs:fha:nhinc:common:nhinccommonentity';
declare namespace urn3='urn:gov:hhs:fha:nhinc:common:nhinccommon';
//urn:RespondingGateway_CrossGatewayQueryRequest[1]/urn:NhinTargetCommunities[1]/urn3:nhinTargetCommunity[1]/urn3:homeCommunity[1]/urn3:description[1]</con:targetPath></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" transferToAll="false" entitize="false" disabled="true" ignoreEmpty="false" useXQuery="false" transferChildNodes="false"><con:name>targetName</con:name><con:sourceType>RemoteHCDescription</con:sourceType><con:sourceStep>Test Case Properties</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Document Query</con:targetStep><con:targetPath>declare namespace urn='urn:gov:hhs:fha:nhinc:common:nhinccommonentity';
declare namespace urn3='urn:gov:hhs:fha:nhinc:common:nhinccommon';
//urn:RespondingGateway_CrossGatewayQueryRequest[1]/urn:NhinTargetCommunities[1]/urn3:nhinTargetCommunity[1]/urn3:homeCommunity[1]/urn3:description[1]</con:targetPath></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true"><con:name>signatureDate</con:name><con:sourceType>sigDate</con:sourceType><con:sourceStep>Test Case Properties</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Document Query</con:targetStep><con:targetPath>declare namespace urn='urn:gov:hhs:fha:nhinc:common:nhinccommonentity';
declare namespace urn3='urn:gov:hhs:fha:nhinc:common:nhinccommon';
//urn:RespondingGateway_CrossGatewayQueryRequest[1]/urn:assertion[1]/urn3:dateOfSignature[1]</con:targetPath></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" useXQuery="false" entitize="false" transferChildNodes="false"><con:name>expirationDate</con:name><con:sourceType>expireDate</con:sourceType><con:sourceStep>Test Case Properties</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Document Query</con:targetStep><con:targetPath>declare namespace urn='urn:gov:hhs:fha:nhinc:common:nhinccommonentity';
declare namespace urn3='urn:gov:hhs:fha:nhinc:common:nhinccommon';
//urn:RespondingGateway_CrossGatewayQueryRequest[1]/urn:assertion[1]/urn3:expirationDate[1]</con:targetPath></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true"><con:name>assertionHCID</con:name><con:sourceType>LocalHCID</con:sourceType><con:sourceStep>Test Case Properties</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Document Query</con:targetStep><con:targetPath>declare namespace urn='urn:gov:hhs:fha:nhinc:common:nhinccommonentity';
declare namespace urn3='urn:gov:hhs:fha:nhinc:common:nhinccommon';
//urn:RespondingGateway_CrossGatewayQueryRequest[1]/urn:assertion[1]/urn3:homeCommunity[1]/urn3:homeCommunityId[1]</con:targetPath></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true"><con:name>assertionHCName</con:name><con:sourceType>LocalHCDescription</con:sourceType><con:sourceStep>Test Case Properties</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Document Query</con:targetStep><con:targetPath>declare namespace urn='urn:gov:hhs:fha:nhinc:common:nhinccommonentity';
declare namespace urn3='urn:gov:hhs:fha:nhinc:common:nhinccommon';
//urn:RespondingGateway_CrossGatewayQueryRequest[1]/urn:assertion[1]/urn3:homeCommunity[1]/urn3:name[1]</con:targetPath></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true"><con:name>assertionHCDescription</con:name><con:sourceType>LocalHCDescription</con:sourceType><con:sourceStep>Test Case Properties</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Document Query</con:targetStep><con:targetPath>declare namespace urn='urn:gov:hhs:fha:nhinc:common:nhinccommonentity';
declare namespace urn3='urn:gov:hhs:fha:nhinc:common:nhinccommon';
//urn:RespondingGateway_CrossGatewayQueryRequest[1]/urn:assertion[1]/urn3:homeCommunity[1]/urn3:description[1]</con:targetPath></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true"><con:name>orgHCID</con:name><con:sourceType>LocalHCID</con:sourceType><con:sourceStep>Test Case Properties</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Document Query</con:targetStep><con:targetPath>declare namespace urn='urn:gov:hhs:fha:nhinc:common:nhinccommonentity';
declare namespace urn3='urn:gov:hhs:fha:nhinc:common:nhinccommon';
//urn:RespondingGateway_CrossGatewayQueryRequest[1]/urn:assertion[1]/urn3:userInfo[1]/urn3:org[1]/urn3:homeCommunityId[1]</con:targetPath></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true"><con:name>orgHCName</con:name><con:sourceType>LocalHCDescription</con:sourceType><con:sourceStep>Test Case Properties</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Document Query</con:targetStep><con:targetPath>declare namespace urn='urn:gov:hhs:fha:nhinc:common:nhinccommonentity';
declare namespace urn3='urn:gov:hhs:fha:nhinc:common:nhinccommon';
//urn:RespondingGateway_CrossGatewayQueryRequest[1]/urn:assertion[1]/urn3:userInfo[1]/urn3:org[1]/urn3:name[1]</con:targetPath></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" transferToAll="false" ignoreEmpty="false" useXQuery="false" entitize="false" transferChildNodes="false"><con:name>orgHCDescription</con:name><con:sourceType>LocalHCDescription</con:sourceType><con:sourceStep>Test Case Properties</con:sourceStep><con:targetType>Request</con:targetType><con:targetStep>Document Query</con:targetStep><con:targetPath>declare namespace urn='urn:gov:hhs:fha:nhinc:common:nhinccommonentity';
declare namespace urn3='urn:gov:hhs:fha:nhinc:common:nhinccommon';
//urn:RespondingGateway_CrossGatewayQueryRequest[1]/urn:assertion[1]/urn3:userInfo[1]/urn3:org[1]/urn3:description[1]</con:targetPath></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="Copy gateway.properties"><con:settings/><con:config><script>import java.io.File;

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );
def propertyList = testRunner.testCase.getTestStepByName( "Test Case Properties" );
def NHINGatewayConfigDir = propertyList.getPropertyValue( "NHINGatewayConfigDir" );
def GatewayConfigFile = NHINGatewayConfigDir + "/gateway.properties"
def GatewayConfigFileBak = GatewayConfigFile + ".bak";

File myFile = new File(GatewayConfigFile);
assert (myFile.exists())
if(myFile.exists())
{
    new File(GatewayConfigFileBak).withWriter 
    { 
        file -> new File(GatewayConfigFile).eachLine 
        { 
            line -> file.writeLine(line)  
        }
    }
}
File backupFile = new File(GatewayConfigFile);
assert (backupFile.exists())
</script></con:config></con:testStep><con:testStep type="groovy" name="Set dQQS = true"><con:settings/><con:config><script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );
def propertyList = testRunner.testCase.getTestStepByName( "Test Case Properties" );
def NHINGatewayConfigDir = propertyList.getPropertyValue( "NHINGatewayConfigDir" );
def gatewayProperties = NHINGatewayConfigDir + "/gateway.properties";
def propertyFile = new File( gatewayProperties );
def fileFound = (propertyFile.exists());

if (fileFound) {
	def fis = new FileInputStream ( propertyFile );
	def properties = new java.util.Properties ();
	properties.load (fis);
	properties.setProperty( "documentQueryQuerySelf", "true" );
	def fos = new java.io.FileOutputStream ( propertyFile );
	properties.store( fos, "");
}

assert fileFound;</script></con:config></con:testStep><con:testStep type="request" name="Document Query"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>EntityDocQueryBindingSoap11</con:interface><con:operation>RespondingGateway_CrossGatewayQuery</con:operation><con:request name="Document Query"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://mhsnhie3.fedsconnect.org:9080/NhinConnect/EntityDocQuery</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:urn="urn:gov:hhs:fha:nhinc:common:nhinccommonentity" xmlns:urn1="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:urn2="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0" xmlns:urn3="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soapenv:Header/>
   <soapenv:Body>
      <urn:RespondingGateway_CrossGatewayQueryRequest>
         <urn1:AdhocQueryRequest federated="false" startIndex="0" maxResults="-1">
            <urn1:ResponseOption returnType="RegistryObject" returnComposedObjects="false"/>
            <urn2:AdhocQuery home="urn:oid:2.16.840.1.113883.3.198" id="urn:uuid:14d4debf-8f97-4251-9a74-a90016b0af0d">
               <urn2:Slot name="$XDSDocumentEntryStatus">
                  <urn2:ValueList>
                     <urn2:Value>('urn:oasis:names:tc:ebxml-regrep:StatusType:Approved')</urn2:Value>
                  </urn2:ValueList>
               </urn2:Slot>
               <urn2:Slot name="$XDSDocumentEntryPatientId">
                  <urn2:ValueList>
                     <urn2:Value>D123401^^^&amp;2.16.840.1.113883.3.198&amp;ISO</urn2:Value>
                  </urn2:ValueList>
               </urn2:Slot>
            </urn2:AdhocQuery>
         </urn1:AdhocQueryRequest>
         <urn:assertion>
            <urn3:address>
               <urn3:addressType>
                  <urn3:code>W</urn3:code>
               </urn3:addressType>
               <urn3:city>BUFFALO</urn3:city>
               <urn3:country>USA</urn3:country>
               <urn3:state>NY</urn3:state>
               <urn3:streetAddress>12345 EAST COAST WAY</urn3:streetAddress>
               <urn3:zipCode>01010</urn3:zipCode>
            </urn3:address>
            <urn3:dateOfBirth>19800516</urn3:dateOfBirth>
            <urn3:dateOfSignature>06/18/2009 17:51:44</urn3:dateOfSignature>
            <urn3:expirationDate>07/18/2009 17:56:44</urn3:expirationDate>
            <urn3:explanationNonClaimantSignature>NEEDED</urn3:explanationNonClaimantSignature>
            <urn3:haveSecondWitnessSignature>true</urn3:haveSecondWitnessSignature>
            <urn3:haveSignature>true</urn3:haveSignature>
            <urn3:haveWitnessSignature>true</urn3:haveWitnessSignature>
            <urn3:homeCommunity>
               <urn3:description>Federal - DoD</urn3:description>
               <urn3:homeCommunityId>2.16.840.1.113883.3.198</urn3:homeCommunityId>
               <urn3:name>Federal - DoD</urn3:name>
            </urn3:homeCommunity>
            <urn3:personName>
               <urn3:familyName>JONES</urn3:familyName>
               <urn3:givenName>FRED</urn3:givenName>
               <urn3:nameType>
                  <urn3:code>G</urn3:code>
               </urn3:nameType>
               <urn3:secondNameOrInitials>ANDREW</urn3:secondNameOrInitials>
            </urn3:personName>
            <urn3:phoneNumber>
               <urn3:areaCode>703</urn3:areaCode>
               <urn3:countryCode>1</urn3:countryCode>
               <urn3:extension>1212</urn3:extension>
               <urn3:localNumber>555</urn3:localNumber>
               <urn3:phoneNumberType>
                  <urn3:code>W</urn3:code>
               </urn3:phoneNumberType>
            </urn3:phoneNumber>
            <urn3:purposeOfDisclosure>NEEDED FOR SSA</urn3:purposeOfDisclosure>
            <urn3:secondWitnessAddress>
               <urn3:addressType>
                  <urn3:code>W</urn3:code>
               </urn3:addressType>
               <urn3:city>ALBANY</urn3:city>
               <urn3:country>USA</urn3:country>
               <urn3:state>NY</urn3:state>
               <urn3:streetAddress>4 TROY STREET</urn3:streetAddress>
               <urn3:zipCode>01033</urn3:zipCode>
            </urn3:secondWitnessAddress>
            <urn3:secondWitnessName>
               <urn3:familyName>JONES</urn3:familyName>
               <urn3:givenName>JAMES</urn3:givenName>
               <urn3:nameType>
                  <urn3:code>G</urn3:code>
               </urn3:nameType>
               <urn3:secondNameOrInitials>KENNETH</urn3:secondNameOrInitials>
            </urn3:secondWitnessName>
            <urn3:secondWitnessPhone>
               <urn3:areaCode>301</urn3:areaCode>
               <urn3:countryCode>1</urn3:countryCode>
               <urn3:extension>555</urn3:extension>
               <urn3:localNumber>0001</urn3:localNumber>
               <urn3:phoneNumberType>
                  <urn3:code>W</urn3:code>
               </urn3:phoneNumberType>
            </urn3:secondWitnessPhone>
            <urn3:SSN>123456789</urn3:SSN>
            <urn3:uniquePatientId>D123401</urn3:uniquePatientId>
            <urn3:witnessAddress>
               <urn3:addressType>
                  <urn3:code>H</urn3:code>
               </urn3:addressType>
               <urn3:city>HARTFORD</urn3:city>
               <urn3:country>USA</urn3:country>
               <urn3:state>CT</urn3:state>
               <urn3:streetAddress>10410 MAIN ST.</urn3:streetAddress>
               <urn3:zipCode>05032</urn3:zipCode>
            </urn3:witnessAddress>
            <urn3:witnessName>
               <urn3:familyName>COREY</urn3:familyName>
               <urn3:givenName>AMANDA</urn3:givenName>
               <urn3:nameType>
                  <urn3:code>H</urn3:code>
               </urn3:nameType>
               <urn3:secondNameOrInitials>EVE</urn3:secondNameOrInitials>
            </urn3:witnessName>
            <urn3:witnessPhone>
               <urn3:areaCode>202</urn3:areaCode>
               <urn3:countryCode>1</urn3:countryCode>
               <urn3:extension>555</urn3:extension>
               <urn3:localNumber>1010</urn3:localNumber>
               <urn3:phoneNumberType>
                  <urn3:code>H</urn3:code>
               </urn3:phoneNumberType>
            </urn3:witnessPhone>
            <urn3:userInfo>
               <urn3:personName>
                  <urn3:familyName>FRANKLIN</urn3:familyName>
                  <urn3:givenName>MARK</urn3:givenName>
                  <urn3:nameType>
                     <urn3:code>P</urn3:code>
                  </urn3:nameType>
                  <urn3:secondNameOrInitials>ALAN</urn3:secondNameOrInitials>
               </urn3:personName>
               <urn3:userName>mfranklin</urn3:userName>
               <urn3:role>Administrator</urn3:role>
               <urn3:org>
                  <urn3:description>Federal - DoD</urn3:description>
                  <urn3:homeCommunityId>2.16.840.1.113883.3.198</urn3:homeCommunityId>
                  <urn3:name>Federal - DoD</urn3:name>
               </urn3:org>
               <urn3:roleCoded>
                  <urn3:code>80584001</urn3:code>
                  <urn3:codeSystem>2.16.840.1.113883.6.96</urn3:codeSystem>
                  <urn3:codeSystemName>SNOMED_CT</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>Psychiatrist</urn3:displayName>
                  <urn3:originalText>Psychiatrist</urn3:originalText>
               </urn3:roleCoded>
            </urn3:userInfo>
            <urn3:authorized>true</urn3:authorized>
            <urn3:purposeOfDisclosureCoded>
               <urn3:code>PSYCHOTHERAPY</urn3:code>
               <urn3:codeSystem>2.16.840.1.113883.3.18.7.1</urn3:codeSystem>
               <urn3:codeSystemName>nhin-purpose</urn3:codeSystemName>
               <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
               <urn3:displayName>Use or disclosure of Psychotherapy Notes</urn3:displayName>
               <urn3:originalText>Psychotherapy Notes</urn3:originalText>
            </urn3:purposeOfDisclosureCoded>
            <urn3:claimFormRef>Ref-Clm-123</urn3:claimFormRef>
            <urn3:claimFormRaw>YWVvbGlhbQ==</urn3:claimFormRaw>
         </urn:assertion>
      </urn:RespondingGateway_CrossGatewayQueryRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response"/><con:assertion type="SOAP Fault Assertion"/><con:assertion type="Simple NotContains"><con:configuration><token>We did not recieve a response to a document query message from this NHIN gateway.</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:wsaConfig mustUnderstand="NONE" version="200508"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="Restore gateway.properties"><con:settings/><con:config><script>import java.io.File;

def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );
def propertyList = testRunner.testCase.getTestStepByName( "Test Case Properties" );
def NHINGatewayConfigDir = propertyList.getPropertyValue( "NHINGatewayConfigDir" );
def GatewayConfigFile = NHINGatewayConfigDir + "/gateway.properties"
def GatewayConfigFileBak = GatewayConfigFile + ".bak";

File backupFile = new File(GatewayConfigFileBak);
assert (backupFile.exists())
if(backupFile.exists())
{
    new File(GatewayConfigFile).withWriter 
    { 
        file -> new File(GatewayConfigFileBak).eachLine 
        { 
            line -> file.writeLine(line)  
        }
    }

    File copiedFile = new File(GatewayConfigFile);
    assert (copiedFile.exists())
    if(copiedFile.exists())
    {
        backupFile.delete();
    }
}
</script></con:config></con:testStep><con:properties/></con:testCase><con:properties/></con:testSuite><con:properties/><con:wssContainer/></con:soapui-project>